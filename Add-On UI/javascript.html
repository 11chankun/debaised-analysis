<script>

  function getSelectedRange(rangePicker,idName){
    rangePicker.innerHTML = "Selecting"; // Change the button value while getting range
    rangePicker.disabled = true;         // Disable the button while getting range

    var RangeObj = {
      "rangePicker" : rangePicker,
      "idName" : idName
    }
    google.script.run                           // Executes a Apps Script function - getSelectedRange
          .withSuccessHandler(updateRangeField) // updateRangeField will be called upon successfull completion of Apps Script function
          .withUserObject(RangeObj)             // To pass argument to updateRangeField
          .getSelectedRange();                  
    return;
  }
        
  // Function to be called on success
  function updateRangeField(range,RangeObj){
    document.getElementById(RangeObj.idName).value = range;      // Update the text field value
    RangeObj.rangePicker.innerHTML = "Get Selected Range";       // Reset the button value
    RangeObj.rangePicker.disabled = false;                       // Enable the button
  }
      
  var ids=0;  //counter for slices created
  var idg=0;  //counter for groups created
  var idd=0;  //counter for dimensions created
    
  function funcAddGroup(){
    idg++;  //increment number of groups created
    var groupId='g'+idg;  //id of the group element that will be created
    var html= '<div class="inline">'+
                '<label for="grp-by'+idg+'">Group By: </label>'+
                '<input type="text" name="grp-by" id="grp-by'+idg+'" class="width130" placeholder="column">'+
              '</div>'+
              '<button name="delete" class="red btn-delete1" onclick="removeElement(\''+groupId+'\')">DELETE</button>';
    addElement('group','div',groupId,html);   //parentId, elementTag, elementId, html
  }
    
  function funcAddDimension(){
    idd++; //increment number of dimensions created
    var dimensionId ='d'+idd;
    var html= '<div class="inline">'+
                '<label for="dim-col'+idd+'">Column Name: </label>'+
                '<input type="text" name="dim-col" id="dim-col'+idd+'" class="width100" placeholder="column">'+
              '</div>'+
              '<button name="delete" class="red btn-delete1" onclick="removeElement(\''+dimensionId+'\')">DELETE</button>';
    addElement('dimension','div',dimensionId,html);   //parentId, elementTag, elementId, html
  }

  function funcAddSlice(){
    ids++;   //increment number of slices created
    var sliceId='s'+ids;  //id of the slice element that will be created
    var html= '<div name="filter" class="box-slice">'+
                '<button name="delete-filter" class="red btn-del-filter" onclick="removeElement(\''+sliceId+'\')">x</button>'+
                '<br>'+
                '<div id="part1-slice" class="block">'+
                  '<label for="slice-col'+ids+'" class="inline">Slice Column Name:&ensp;</label>'+
                  '<input type="text" name="slice-col" id="slice-col'+ids+'" class="width90" placeholder="column">'+
                '</div>'+
                '<div id="part2-slice" class="block">'+
                  '<label for="slice-op'+ids+'" class="inline">Filter Operation:&ensp;</label>'+
                  '<select id="slice-op'+ids+'" name="slice-op" class="width100">'+
                    '<option>Equal to</option>'+
                    '<option>Not equal to</option>'+
                    '<option>Less than</option>'+
                    '<option>Less than equal to</option>'+
                    '<option>Greater than</option>'+
                    '<option>Greater than equal to</option>'+
                    '<option>In</option>'+
                    '<option>Not In</option>'+
                  '</select>'+
                '</div>'+
                '<div id="part3-slice" class="block form-group">'+
                  '<label for="slice-val'+ids+'">Filter Value: </label>'+
                  '<textarea id="slice-val'+ids+'" name="slice-val" placeholder="Values(separated by ,)" cols="30"></textarea>'+
                '</div>'+
              '</div>';
    addElement('slice','div',sliceId,html);   //parentId, elementTag, elementId, html
  }
    
  function funcAddDate(button){
    var text=button.textContent;
    if(text=="ADD"){
      var html= '<div class="block">'+
                  '<label for="date-col">Date Column:&ensp;</label>'+
                  '<input type="text" id="date-col" name="date-col" class="width130" placeholder="column"> '+
                '</div>'+
                '<div class="block">'+
                  '<div class="inline form-group">'+
                    '<label for="date-start">Start Date:</label>'+
                    '<input type="date" id="date-start" name="date-start" class="width125">'+
                  '</div>'+
                  '<div class="inline form-group">'+
                    '<label for="date-end">End Date:</label>'+
                    '<input type="date" id="date-end" name="date-end" class="width125">'+
                  '</div>'+
                '</div>';
      addElement('date','div',"date-range",html);   //parentId, elementTag, elementId, html
      button.classList.remove("share","btn-add");
      button.classList.add("red","btn-delete2");
      button.textContent="DELETE";
    }
    else{
      removeElement("date-range");
      button.classList.remove("red","btn-delete2");
      button.classList.add("share","btn-add");
      button.textContent="ADD";
    }
  }
    
  function funcAddGranularity(button){
    var text=button.textContent;
    if(text=="ADD"){
      var html= '<div class="drp1">'+
                  '<div class="drp2">'+
                    '<select id="period">'+
                      '<option>Hourly</option>'+
                      '<option>Daily</option>'+
                      '<option>Fortnightly</option>'+
                      '<option>Monthly</option>'+
                      '<option>Quarterly</option>'+
                      '<option>Semi-Annually</option>'+
                      '<option>Annually</option>'+
                    '</select>'+
                  '</div>'+
                '</div>';
      addElement('granularity','div',"grn",html);   //parentId, elementTag, elementId, html
      button.classList.remove("share","btn-add");
      button.classList.add("red","btn-delete2");
      button.textContent="DELETE";
    }
    else{
      console.log("removing");
      removeElement("grn");
      button.classList.remove("red","btn-delete2");
      button.classList.add("share","btn-add");
      button.textContent="ADD";
    }
  }
    
  function addElement(parentId, elementTag, elementId, html) {
    // Adds an element to the document
    var p = document.getElementById(parentId);
    var newElement = document.createElement(elementTag);
    newElement.setAttribute('id', elementId);
    newElement.setAttribute('class', "block");
    newElement.innerHTML = html;
    p.appendChild(newElement);
  }
    
  function removeElement(elementId) {
    // Removes an element from the document
    var element = document.getElementById(elementId);
    element.parentNode.removeChild(element);
  }
    
</script>



