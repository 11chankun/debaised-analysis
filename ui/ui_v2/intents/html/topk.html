<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <?!= include("autocomplete/css/awesomplete_css"); ?>
    <?!= include('css'); ?>
  </head>
  
  <body>
    <div class="sidebar branding-below">
      <form id="form" autocomplete="on">

        <h4 style ="text-align:center">
          <em>Top-K</em>: Display <em>top-k</em> items based on provided criterion
        </h4>
       
        <!-- DIMENSION -->
        <?!= include('aspects/html/dimension'); ?>
        
        <!-- METRIC -->
        <?!= include('aspects/html/metric_summary'); ?>   

        <!-- SORTING and LIMIT -->
        <?!= include('aspects/html/sort_k'); ?>   
         
        <!-- SLICE -->
        <?!= include('aspects/html/slice'); ?>
      
        <!-- DATE RANGE -->
        <?!= include('aspects/html/date_range'); ?>
        
        <div class="block" id="result" name="result">
        </div>

        <!--BUTTONS-->
        <div class="block">
          <button type="submit" class="blue" id="done" onClick="evaluateQuery('topk',event)">Compute</button>
          <button name="close" class="grey" onClick="google.script.host.close()">Cancel</button>
        </div>
        <!--BUTTONS END--> 
       
      </form>

    </div>
    
    <!-- INCLUDING SCRIPT FILES -->
    
    <!-- Javascript Functions that handle autocompletion -->
    <?!= include("autocomplete/javascript/awesomplete_js"); ?>
    <?!= include("autocomplete/javascript/autocomplete_functions"); ?> 

    <!-- Javascript Functions for fetching headers from the selected header row -->
    <?!= include('intents/javascript/header_finder'); ?>

    <!-- Javascript Functions for adding dimensions -->
    <?!= include('aspects/javascript/dimension'); ?>
    
    <!-- Javascript Functions for adding metric and summary -->
    <?!= include('aspects/javascript/metric_summary'); ?>

    <!-- Javascript Functions for adding slices -->
    <?!= include('aspects/javascript/slice'); ?>
    
    <!-- Javascript Functions for adding date-range field -->
    <?!= include('aspects/javascript/date_range'); ?>

    <!-- Javascript Functions for adding sorting for limits -->
    <?!= include('aspects/javascript/sort_k'); ?>
    
    <!-- Javascript Functions for extracting data filled by user and 
    calling server-side Apps Script function to get the result -->
    <?!= include('intents/javascript/submit_form'); ?>
    
    <!-- Javascript Helper Functions to perform repetitive tasks and keep code DRY -->
    <?!= include('intents/javascript/helper_functions'); ?>

    
  </body>
</html>